[English](README.md) | **فارسی**

* * *

Smart-SSL
=========

_**دستیار هوشمند Let's Encrypt و Cloudflare برای مدیریت یکپارچه گواهینامه‌های SSL.**_

> ### 🚀 نصب سریع
> 
> برای نصب و اجرای اسکریپت در یک خط، دستور زیر را اجرا کنید:
> 
>     bash <(curl -fsSL https://raw.githubusercontent.com/Nima786/Smart-SSL/main/quick-install.sh)

>  یک اسکریپت قدرتمند Bash که با ادغام `certbot` با API DNS کلودفلر، قابلیت‌های آن را افزایش می‌دهد. این اسکریپت به شما امکان می‌دهد گواهینامه‌های SSL از Let's Encrypt—شامل گواهینامه‌های **wildcard** و **چند دامنه‌ای**—را بدون نیاز به باز بودن پورت‌های 80 یا 443 روی سرور خود صادر و مدیریت کنید. این یک راه‌حل کامل و منو-محور برای مدیریت آسان، امن و انعطاف‌پذیر گواهینامه‌ها است.

* * *

✨ ویژگی‌های کلیدی
-----------------

*   ✅ **اعتبارسنجی با DNS کلودفلر:** گواهینامه‌های SSL را بدون نیاز به باز گذاشتن پورت 80 سرور دریافت کنید. ایده‌آل برای سرویس‌های داخلی، سرورهای پشت فایروال یا تنظیمات غیر استاندارد.
*   ✅ **پشتیبانی از گواهی چند دامنه‌ای:** صدور گواهینامه‌های مجزا برای چندین دامنه کاملاً متفاوت (مانند `site1.com` و `api.site2.net`) در یک عملیات.
*   ✅ **پشتیبانی از گواهی Wildcard:** به راحتی تمام زیردامنه‌های خود (`*.example.com`) را با یک گواهینامه امن کنید.
*   ✅ **انتشار خودکار:** پس از تمدید، گواهینامه‌ها را به صورت خودکار در مسیر دلخواه شما کپی می‌کند تا برنامه‌های شما همیشه از آخرین نسخه استفاده کنند.
*   ✅ **مدیریت هوشمند:** منوهای تعاملی به صورت هوشمند گواهینامه‌های واقعی شما را بررسی می‌کنند، بنابراین همیشه لیست کامل و صحیح دامنه‌های تحت پوشش را مشاهده می‌کنید.
*   ✅ **مدیریت کامل چرخه عمر:** یک منوی عددی و کاربرپسند برای افزودن، لیست کردن، حذف و مدیریت دامنه‌های شما با گزینه‌های پیش‌فرض امن برای جلوگیری از اشتباه.
*   ✅ **انتقال آسان:** گواهینامه‌های موجود `certbot` را به مدیریت Smart-SSL وارد کنید یا آن‌ها را از روش‌های استاندارد به روش قدرتمندتر DNS کلودفلر تبدیل کنید.
*   ✅ **هوشمند و مستقل:** شامل نصب خودکار نیازمندی‌ها، به‌روزرسانی خودکار و حذف کامل و تمیز اسکریپت.
*   ✅ **امنیت بالا:** توکن API کلودفلر شما را با مجوزهای دسترسی مناسب و به صورت امن مدیریت می‌کند.

* * *

🚀 چرا Smart-SSL؟
-----------------

با اینکه `certbot` ابزار فوق‌العاده‌ای است، مدیریت گواهینامه‌ها می‌تواند پیچیده شود، به خصوص در سناریوهایی که وب‌سرور استاندارد وجود ندارد یا نیاز به گواهی wildcard باشد. Smart-SSL این شکاف را پر می‌کند.

> ✅ **بزرگترین مزیت:** روش DNS کلودفلر. Smart-SSL فرآیند افزودن رکورد موقت DNS TXT برای اثبات مالکیت دامنه را خودکار می‌کند. این یعنی:
> 
> *   **بدون قطعی سرویس:** نیازی به متوقف کردن وب‌سرور برای صدور گواهی نیست.
> *   **بدون نیاز به پورت باز:** سرور شما می‌تواند در برابر ترافیک وب عمومی روی پورت 80 کاملاً پشت فایروال بماند.
> *   **انعطاف‌پذیری نهایی:** برای هر دستگاهی گواهی دریافت کنید، نه فقط برای وب‌سرورهای عمومی.

* * *

🛠️ نصب و راه‌اندازی
--------------------

### ۱. دانلود اسکریپت

    curl -sSL https://raw.githubusercontent.com/Nima786/Smart-SSL/main/smart-ssl -o /usr/local/bin/smart-ssl
    chmod +x /usr/local/bin/smart-ssl

### ۲. اجرای منوی تعاملی

کافیست اسکریپت را با دسترسی root اجرا کنید تا منوی اصلی نمایش داده شود:

    sudo smart-ssl

### ۳. راه‌اندازی اولیه

از منوی اصلی، این دو مرحله یک‌باره را انجام دهید:

1.  **گزینه ۱) نصب نیازمندی‌ها** را انتخاب کنید تا از نصب `certbot` و پلاگین کلودفلر اطمینان حاصل شود.
2.  **گزینه ۲) راه‌اندازی** را انتخاب کنید تا ایمیل Let's Encrypt و توکن API کلودفلر خود را پیکربندی کنید.

> ⚠️ **توکن API کلودفلر:** می‌توانید یک توکن از داشبورد کلودفلر خود ایجاد کنید. به **My Profile → API Tokens → Create Token** بروید. از قالب "Edit zone DNS" برای مجوزهای لازم استفاده کنید.

* * *

📖 روش‌های استفاده رایج
-----------------------

### صدور گواهینامه (روش کلودفلر)

این روش برای اکثر موارد استفاده توصیه می‌شود. از منوی اصلی، **گزینه ۳) افزودن گواهینامه (Cloudflare DNS)** را انتخاب کنید.

1.  **نوع گواهینامه را انتخاب کنید:**
    *   **۱) گواهی ساده** را برای یک یا چند دامنه خاص انتخاب کنید.
    *   **۲) گواهی Wildcard** را برای یک دامنه واحد (مانند `*.example.com`) انتخاب کنید.
2.  **دامنه(های) خود را وارد کنید:**
    *   برای گواهی ساده، می‌توانید یک دامنه (`site1.com`) یا لیستی از دامنه‌ها با کاما (`site1.com,site2.net`) وارد کنید. اسکریپت برای هر کدام یک گواهی جداگانه دریافت می‌کند.
    *   برای گواهی Wildcard، دامنه پایه (`example.com`) را وارد کنید.
3.  **(اختیاری) مسیر انتشار را مشخص کنید:** این مسیری است که Smart-SSL فایل‌های گواهینامه (`privkey.pem` و `fullchain.pem`) را برای استفاده برنامه‌های شما کپی می‌کند.

### مدیریت گواهینامه‌ها

*   **لیست دامنه‌ها (گزینه ۵):** مشاهده تمام گواهینامه‌های مدیریت شده، لیست کامل دامنه‌های تحت پوشش، مسیرهای انتشار و تاریخ انقضا.
*   **تغییر مسیر انتشار (گزینه ۶):** به‌روزرسانی مسیر مقصد برای یک گواهینامه و انتشار فوری آخرین نسخه.
*   **حذف دامنه (گزینه ۹):** حذف امن یک گواهینامه هم از Smart-SSL و هم از `certbot`. منو تمام دامنه‌های تحت پوشش گواهینامه‌ای که حذف می‌کنید را نمایش می‌دهد.

* * *

🔮 ویژگی‌های پیشرفته
--------------------

### وارد کردن گواهینامه موجود (گزینه ۱۰)

آیا از قبل روی سرور خود گواهینامه دارید؟ می‌توانید آن‌ها را تحت مدیریت Smart-SSL بیاورید تا از ویژگی‌هایی مانند انتشار خودکار بهره‌مند شوید.

1.  **گزینه ۱۰) وارد کردن گواهینامه موجود Certbot** را انتخاب کنید.
2.  گواهینامه‌ای که می‌خواهید مدیریت شود را از لیست انتخاب کنید.
3.  در صورت نیاز، یک مسیر انتشار تعریف کنید.

### تبدیل به DNS کلودفلر (گزینه ۱۱)

یک گواهینامه موجود (مثلاً صادر شده با روش `webroot`) را به روش قوی‌تر DNS کلودفلر ارتقا دهید.

1.  **گزینه ۱۱) تبدیل گواهی موجود به DNS کلودفلر** را انتخاب کنید.
2.  گواهینامه مورد نظر برای تبدیل را انتخاب کنید. اسکریپت به طور خودکار آن را با استفاده از API کلودفلر دوباره صادر می‌کند.

* * *

⚙️ نگهداری
----------

*   **به‌روزرسانی خودکار (گزینه ۱۲):** آخرین نسخه اسکریپت را مستقیماً از GitHub دریافت می‌کند.
*   **حذف (گزینه ۱۳):** یک برنامه حذف جامع که اسکریپت و تنظیمات آن را به طور کامل پاک می‌کند.
*   **تمدید دستی (گزینه ۷):** یک اجرای آزمایشی (dry run) از فرآیند تمدید برای دامنه‌های مدیریت شده خود انجام دهید تا تنظیمات خود را تست کنید.

* * *

🤖 خط فرمان غیرتعاملی
---------------------

هر گزینه منو به عنوان یک آرگومان خط فرمان نیز در دسترس است، که Smart-SSL را برای اتوماسیون ایده‌آل می‌سازد. برای مشاهده تمام دستورات موجود، `smart-ssl help` را اجرا کنید.

    # مثال: لیست دامنه‌ها از خط فرمان
    smart-ssl list
    
    # مثال: انتشار گواهینامه برای یک دامنه خاص
    smart-ssl publish mydomain.com

* * *

مجوز (License)
--------------

MIT License

Copyright (c) 2024 Nima

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
