<p align="center">
  <b><a href="README.md">English</b>|فارسی</a>
</p>
<hr>

Smart-SSL
=========

### اسکریپت قدرتمند Let's Encrypt و Cloudflare برای مدیریت یکپارچه گواهینامه‌ها

## 🚀 راه‌اندازی سریع

برای نصب و اجرای سریع، دستور زیر را در ترمینال خود کپی و اجرا کنید:

    bash <(curl -fsSL https://raw.githubusercontent.com/Nima786/Smart-SSL/main/quick-install.sh)

  

✨ اسکریپت **Smart-SSL** یک اسکریپت قدرتمند Bash است که با ادغام `certbot` با DNS API کلودفلر، قابلیت‌های آن را به سطح بالاتری می‌برد. این ابزار به شما امکان می‌دهد گواهینامه‌های SSL از Let's Encrypt—شامل گواهینامه‌های **Wildcard**—را بدون نیاز به باز بودن پورت‌های (80/443) روی سرور خود صادر و مدیریت کنید. این یک راه‌حل کامل و منو-محور برای مدیریت بی‌دردسر، امن و انعطاف‌پذیر گواهینامه‌ها است.

* * *

✨ ویژگی‌های کلیدی
-----------------

*   ✅ **چالش DNS-01 کلودفلر:** گواهینامه‌های SSL را بدون نیاز به باز گذاشتن پورت 80 سرور به اینترنت دریافت کنید. ایده‌آل برای سرویس‌های داخلی، سرورهای پشت فایروال یا تنظیمات غیر استاندارد.
*   ✅ **پشتیبانی از گواهینامه Wildcard:** به راحتی تمام زیردامنه‌های خود (`*.example.com`) را با یک گواهینامه امن کنید.
*   ✅ **متدهای استاندارد Certbot:** پشتیبانی کامل از چالش‌های سنتی `standalone` و `webroot` در صورت تمایل.
*   ✅ **انتشار خودکار:** گواهینامه‌های تمدید شده را به صورت خودکار در مسیر دلخواه شما کپی می‌کند تا برنامه‌های شما همیشه از آخرین نسخه گواهینامه استفاده کنند.
*   ✅ **مدیریت کامل چرخه عمر:** یک منوی کاربرپسند برای افزودن، لیست کردن، حذف و مدیریت دامنه‌های شما.
*   ✅ **مهاجرت آسان:** گواهینامه‌های موجود `certbot` را به مدیریت Smart-SSL وارد کنید یا آن‌ها را از متدهای استاندارد به متد قدرتمندتر DNS کلودفلر تبدیل کنید.
*   ✅ **مستقل و هوشمند:** شامل نصب وابستگی‌ها، به‌روزرسانی خودکار و یک حذف‌کننده تمیز.
*   ✅ **امنیت در طراحی:** توکن API کلودفلر شما را با مجوزهای دسترسی مناسب به صورت امن مدیریت می‌کند.

* * *

🚀 چرا Smart-SSL؟
-----------------

درحالی‌که `certbot` ابزاری فوق‌العاده است، مدیریت گواهینامه‌ها می‌تواند پیچیده شود، به خصوص در سناریوهایی که وب سرور استاندارد وجود ندارد یا نیاز به پشتیبانی از Wildcard است. Smart-SSL این شکاف را پر می‌کند.

✅ **بزرگترین مزیت:** متد DNS کلودفلر. Smart-SSL فرآیند افزودن یک رکورد موقت DNS TXT برای اثبات مالکیت دامنه را خودکار می‌کند. این به معنای:

*   **بدون قطعی (Downtime):** نیازی به متوقف کردن وب سرور برای صدور گواهینامه نیست.
*   **بدون نیاز به پورت باز:** سرور شما می‌تواند روی پورت 80 به طور کامل از ترافیک عمومی وب فایروال شده باقی بماند.
*   **انعطاف‌پذیری نهایی:** برای هر دستگاهی گواهینامه دریافت کنید، نه فقط برای وب سرورهای عمومی.

* * *

🛠️ نصب و راه‌اندازی
--------------------

### ۱. دانلود اسکریپت

    curl -sSL https://raw.githubusercontent.com/Nima786/Smart-SSL/main/smart-ssl -o /usr/local/bin/smart-ssl
    chmod +x /usr/local/bin/smart-ssl

### ۲. اجرای منوی تعاملی

کافیست اسکریپت را به عنوان کاربر root اجرا کنید تا منوی اصلی باز شود:

    sudo smart-ssl

### ۳. راه‌اندازی اولیه

از منوی اصلی، این دو مرحله یک‌باره را انجام دهید:

1.  **گزینه ۱) نصب وابستگی‌ها** را انتخاب کنید تا از نصب `certbot` و پلاگین کلودفلر اطمینان حاصل شود.
2.  **گزینه ۲) راه‌اندازی** را انتخاب کنید تا ایمیل Let's Encrypt و توکن API کلودفلر خود را پیکربندی کنید.

⚠️ **توکن API کلودفلر:** شما می‌توانید یک توکن از داشبورد کلودفلر خود ایجاد کنید. به **My Profile → API Tokens → Create Token** بروید. از قالب "Edit zone DNS" برای مجوزهای مورد نیاز استفاده کنید.

* * *

📖 گردش‌کارهای رایج
-------------------

### صدور گواهینامه (متد کلودفلر)

این متد برای اکثر موارد استفاده توصیه می‌شود.

1.  **گزینه ۳) افزودن گواهینامه (Cloudflare DNS)** را انتخاب کنید.
2.  دامنه خود را وارد کنید (مثلاً `example.com`).
3.  حالت را انتخاب کنید: `simple` برای دامنه اصلی یا `wildcard` برای امن کردن تمام زیردامنه‌ها.
4.  (اختیاری) یک **مسیر انتشار (Publish Path)** مشخص کنید. این مسیری است که Smart-SSL فایل‌های گواهینامه (`privkey.pem` و `fullchain.pem`) را برای استفاده برنامه‌های شما در آنجا کپی می‌کند.

### مدیریت گواهینامه‌ها

*   **لیست دامنه‌ها (گزینه ۵):** مشاهده تمام دامنه‌های مدیریت شده، حالت آن‌ها، مسیر انتشار و تاریخ انقضا.
*   **تغییر مسیر انتشار (گزینه ۶):** به‌روزرسانی پوشه مقصد برای یک گواهینامه و انتشار فوری آخرین نسخه.
*   **حذف یک دامنه (گزینه ۹):** توقف مدیریت یک دامنه با Smart-SSL، با امکان حذف گواهینامه از `certbot`.

* * *

🔮 ویژگی‌های پیشرفته
--------------------

### وارد کردن گواهینامه موجود (گزینه ۱۰)

آیا از قبل گواهینامه‌هایی روی سرور خود دارید؟ می‌توانید آن‌ها را تحت مدیریت Smart-SSL قرار دهید تا از ویژگی‌هایی مانند انتشار خودکار بهره‌مند شوید.

1.  **گزینه ۱۰) وارد کردن گواهینامه موجود Certbot** را انتخاب کنید.
2.  گواهینامه‌ای را که می‌خواهید از لیست بپذیرید، انتخاب کنید.
3.  در صورت نیاز، یک مسیر انتشار تعریف کنید.

### تبدیل به DNS کلودفلر (گزینه ۱۱)

یک گواهینامه موجود (مثلاً یکی که با متد `webroot` صادر شده) را به متد قوی‌تر DNS کلودفلر ارتقا دهید.

1.  **گزینه ۱۱) تبدیل گواهینامه موجود Certbot به Cloudflare DNS** را انتخاب کنید.
2.  گواهینامه مورد نظر برای تبدیل را انتخاب کنید. اسکریپت به طور خودکار آن را با استفاده از API کلودفلر مجدداً صادر می‌کند.

* * *

⚙️ نگهداری
----------

*   **به‌روزرسانی خودکار (گزینه ۱۲):** آخرین نسخه اسکریپت را مستقیماً از GitHub دریافت می‌کند.
*   **حذف (گزینه ۱۳):** یک حذف‌کننده جامع که اسکریپت و تنظیمات آن را به طور کامل پاک می‌کند.
*   **تمدید دستی (گزینه ۷):** یک اجرای آزمایشی (dry run) از فرآیند تمدید برای دامنه‌های مدیریت شده خود انجام دهید تا تنظیمات خود را تست کنید.

* * *

🤖 خط فرمان غیر تعاملی (CLI)
----------------------------

هر گزینه منو به عنوان یک آرگومان خط فرمان نیز در دسترس است، که Smart-SSL را برای اتوماسیون ایده‌آل می‌کند. برای دیدن تمام دستورات موجود، `smart-ssl help` را اجرا کنید.

    # مثال: لیست دامنه‌ها از خط فرمان
    smart-ssl list
    
    # مثال: انتشار گواهینامه برای یک دامنه خاص
    smart-ssl publish mydomain.com
